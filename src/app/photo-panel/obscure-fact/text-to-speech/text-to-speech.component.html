<div class="flex justify-evenly">
  <button
      (click)="generateSpeech.emit({ mode: 'sync' })"
      aria-label="Generate speech"
      [disabled]="isLoading()"
      class="mt-6 flex items-center justify-center btn-audio"
  >
    @let c = { isLoading: isLoadingSync(), buttonText: 'Play Speech (Sync)' };
    <ng-container [ngTemplateOutlet]="buttonTemplate" [ngTemplateOutletContext]="c" />
  </button>
  <button
    (click)="generateSpeech.emit({ mode: 'stream' })"
    aria-label="Stream speech"
    [disabled]="isLoading()"
    class="mt-6 flex items-center justify-center btn-audio"
  >
    @let c2 = { isLoading: isLoadingStream(), buttonText: 'Play Speech (Stream)' };
    <ng-container [ngTemplateOutlet]="buttonTemplate" [ngTemplateOutletContext]="c2" />
  </button>
  <button
    (click)="generateSpeech.emit({ mode: 'web_audio_api' })"
    aria-label="Stream speech"
    [disabled]="isLoading()"
    class="mt-6 flex items-center justify-center btn-audio"
  >
    @let c3 = { isLoading: isLoadingWebAudio(), buttonText: 'Web Audio API' };
    <ng-container [ngTemplateOutlet]="buttonTemplate" [ngTemplateOutletContext]="c3" />
  </button>
</div>

@if (audioUrl(); as url) {
    <figure>
      <figcaption>Listen to the Gemini-TTS:</figcaption>
      <audio controls [src]="url" [playbackRate]="'1.25'"></audio>
    </figure>
}

<ng-template #buttonTemplate let-isLoading="isLoading" let-buttonText="buttonText">
  @if (isLoading) {
    <app-spinner-icon class="animate-spin h-5 w-5" />
  }
  {{ isLoading ? 'Generating Speech...' : buttonText }}
</ng-template>
