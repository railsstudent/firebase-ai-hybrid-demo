<div class="flex justify-evenly">
  <button
      (click)="generateSpeech.emit({ isStream: false })"
      aria-label="Generate speech"
      [disabled]="isLoading()"
      class="mt-6 flex items-center justify-center gap-2 bg-brand-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-500 disabled:bg-slate-600 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 disabled:scale-100"
  >
    @let c = { isLoading: isLoadingSync(), buttonText: 'Play Speech (Sync)' };
    <ng-container [ngTemplateOutlet]="buttonTemplate" [ngTemplateOutletContext]="c" />
  </button>
  <button
    (click)="generateSpeech.emit({ isStream: true })"
    aria-label="Stream speech"
    [disabled]="isLoading()"
    class="mt-6 flex items-center justify-center gap-2 bg-brand-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-500 disabled:bg-slate-600 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 disabled:scale-100"
  >
    @let c2 = { isLoading: isLoadingStream(), buttonText: 'Play Speech (Stream)' };
    <ng-container [ngTemplateOutlet]="buttonTemplate" [ngTemplateOutletContext]="c2" />
  </button>
</div>

@if (audioUrl(); as url) {
    <figure>
      <figcaption>Listen to the Gemini-TTS:</figcaption>
      <audio controls [src]="url" [playbackRate]="'1.25'"></audio>
    </figure>
}

<ng-template #buttonTemplate let-isLoading="isLoading" let-buttonText="buttonText">
  @if (isLoading) {
    <app-spinner-icon class="animate-spin h-5 w-5" />
  }
  {{ isLoading ? 'Generating Speech...' : buttonText }}
</ng-template>
